<app-header></app-header>
<!-- Mobile Hero Section -->
<div class="mobile-hero-section">
  <div class="mobile-hero-content">
    <img src="assets/images/client_details_mobile.png" alt="تفاصيل العميل" class="hero-image">
    <h1 class="hero-title">تفاصيل العميل</h1>
  </div>

  <div class="mobile-action-bar">
    <button class="action-btn" (click)="goBack()">
      <img src="assets/icons/back_icon.svg" alt="رجوع">
    </button>
    <button class="action-btn" (click)="exportData()">
      <img src="assets/icons/export_icon.svg" alt="تصدير">
    </button>
    <button class="action-btn" (click)="printPage()">
      <img src="assets/icons/print_icon.svg" alt="طباعة">
    </button>
  </div>

  <!-- Mobile Add Button -->
  <button class="mobile-add-btn" (click)="showAddOptions()">
    <img src="assets/icons/plus_sign_icon.svg" alt="+">
  </button>
</div>

<!-- Mobile Add Menu Overlay -->
<div class="mobile-add-menu" *ngIf="showAddMenu" (click)="closeAddMenu()">
  <div class="add-menu-content" (click)="$event.stopPropagation()">
    <button class="add-option-btn" (click)="addNewOrder()">
      طلب جديد
    </button>

    <button class="add-option-btn" (click)="openPaymentModal()">
      دفعة جديدة
    </button>
  </div>
</div>
<div class="container">
  <!-- Breadcrumb & Title -->
  <div class="breadcrumb">
    <span class="back-link" (click)="goBack()">العودة إلى قائمة العملاء ></span>
  </div>

  <div class="page-header">
    <h1 class="page-title">المضخات</h1>
    <p class="page-subtitle">من شريط العميل</p>
  </div>

  <!-- Main Content -->
  <div class="content-wrapper">
    <!-- Left Section: Invoice Table -->
    <div class="left-section">
      <!-- Action Buttons & Title -->
      <div class="table-header-section">
        <div class="header-actions">
          <button pButton class="export-btn" (click)="exportData()">
            <img src="assets/icons/export_icon.svg" alt="تصدير">
            <span>تصدير</span>
          </button>
          <button pButton class="p-button-text print-btn" (click)="printPage()">
            <img src="assets/icons/print_icon.svg" alt="طباعة">
          </button>
          <button pButton label="طلب جديد" class="p-button-primary add-btn"></button>
          <button pButton label="دفعة جديدة" class="p-button-primary add-btn" (click)="openPaymentModal()"></button>
        </div>
        <h2 class="table-title">حالة الحساب</h2>
      </div>

      <!-- Table with Border -->
      <div class="table-wrapper">
        <div class="invoice-table">
          <!-- Table Headers -->
          <div class="table-header">
            <div class="header-cell actions-col"></div>
            <div class="header-cell">الرصيد</div>
            <div class="header-cell">إجمالي الضريبة</div>
            <div class="header-cell">المبلغ</div>
            <div class="header-cell">الخصم</div>
            <div class="header-cell">المركبة</div>
            <div class="header-cell">العنوان</div>
            <div class="header-cell">النوع</div>
            <div class="header-cell">الوصف</div>
          </div>

          <!-- Table Body -->
          <div class="table-body">
            <div class="table-row" *ngFor="let invoice of invoices">
              <div class="row-cell actions-col">
                <button class="icon-btn delete-btn" (click)="deleteInvoice(invoice)">
                  <i class="pi pi-trash"></i>
                </button>
                <button class="icon-btn edit-btn" (click)="editInvoice(invoice)">
                  <i class="pi pi-pencil"></i>
                </button>
              </div>
              <div class="row-cell">{{ invoice.balance }}</div>
              <div class="row-cell">{{ invoice.totalVat }}</div>
              <div class="row-cell">{{ invoice.amount }}</div>
              <div class="row-cell">{{ invoice.discount }}</div>
              <div class="row-cell">{{ invoice.vehicle }}</div>
              <div class="row-cell">{{ invoice.address }}</div>
              <div class="row-cell">{{ invoice.type }}</div>
              <div class="row-cell description-cell">
                <div class="description-text">{{ invoice.description }}</div>
                <div class="date-text">{{ invoice.date }}</div>
              </div>
            </div>
          </div>

          <!-- Table Footer -->
          <div class="table-footer">
            <div class="footer-content">
              <div class="footer-wrapper">
                <div class="footer-value">{{ totalStats.total1 }}</div>
                <div class="footer-value">{{ totalStats.total2 }}</div>
                <div class="footer-value">{{ totalStats.total3 }}</div>
                <div class="footer-label">:الإجمالي</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Section: Stats & Details -->
    <div class="right-section">
      <!-- Statistics Card -->
      <div class="stats-card">
        <div class="stats-content">
          <div class="stat-item revenue-stat">
            <div class="stat-label">إجمالي الإيرادات</div>
            <div class="stat-value">{{ totalRevenue }}</div>
          </div>

          <div class="stat-item payments-stat">
            <div class="stat-label">إجمالي الدفعات</div>
            <div class="stat-value">{{ totalPayments }}</div>
          </div>

          <div class="stat-item balance-stat">
            <div class="stat-label">إجمالي رصيد الحساب</div>
            <div class="stat-value">{{ remainingBalance }}</div>
          </div>
        </div>

        <h3 class="card-title">ملخص الحساب</h3>
      </div>

      <!-- Contact Details Card -->
      <div class="contact-card" dir="rtl">
        <div class="contact-header">
          <button class="edit-icon-btn">
            <i class="pi pi-pencil"></i>
          </button>
          <h3 class="card-title">التفاصيل العامة</h3>
        </div>

        <div class="contact-section">
          <div class="contact-grid">
            <div class="contact-row">
              <div class="contact-item">
                <div class="contact-label">اسم العميل</div>
                <div class="contact-value">{{ contactDetails.clientName }}</div>
              </div>
              <div class="contact-item">
                <div class="contact-label">العنوان</div>
                <div class="contact-value">{{ contactDetails.address }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="contact-header">
          <button class="edit-icon-btn">
            <i class="pi pi-pencil"></i>
          </button>
          <h3 class="card-title">تفاصيل الاتصال</h3>
        </div>

        <div class="contact-section">
          <div class="contact-grid">
            <div class="contact-row">
              <div class="contact-item">
                <div class="contact-label">טלפון</div>
                <div class="contact-value">{{ contactDetails.phone }}</div>
              </div>
              <div class="contact-item">
                <div class="contact-label">فاكس</div>
                <div class="contact-value">{{ contactDetails.fax }}</div>
              </div>
            </div>
            <div class="contact-row">
              <div class="contact-item">
                <div class="contact-label">نייד</div>
                <div class="contact-value">{{ contactDetails.mobile }}</div>
              </div>
              <div class="contact-item">
                <div class="contact-label">אימייל</div>
                <div class="contact-value email">{{ contactDetails.email }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="mobile-action-bar">
        <!-- Extended Search Input -->
        <div class="mobile-search-input expanded">
          <div class="search-icon">
            <img src="assets/icons/search_icon.svg" alt="search">
          </div>
          <input type="text" placeholder="البحث الحر عن الطلب" >
        </div>
      
        <!-- Calendar Button -->
        <button class="action-btn calendar-btn">
          <img src="assets/icons/calendar_icon.svg" alt="Calendar">
        </button>
      
        <!-- Filter Button -->
        <button class="action-btn filter-mobile-btn">
          <img src="assets/icons/filters_icon.svg" alt="Filter">
        </button>
      </div>
      
    </div>
  </div>
</div>

<!-- Payment Modal Component -->
<app-payment-modal [(visible)]="showPaymentModal" (onSave)="handlePaymentSave($event)"
  (onCancel)="handlePaymentCancel()">
</app-payment-modal>

<app-footer-nav></app-footer-nav>